<!DOCTYPE html>
<html>
<head>
    <title>FINAL MOBILE MERCURYO TEST</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        body { 
            font-family: Arial, sans-serif; 
            padding: 20px; 
            max-width: 450px; 
            margin: 0 auto; 
            background: #f5f5f5;
        }
        .test-button { 
            display: block; 
            width: 100%;
            padding: 25px; 
            font-size: 18px; 
            color: white; 
            border: none; 
            border-radius: 10px;
            margin: 15px 0;
            cursor: pointer;
            font-weight: bold;
            text-align: center;
        }
        .main-test { background: #FF6B35; }
        .main-test:hover { background: #E5552F; }
        .comparison { background: #2196F3; }
        .comparison:hover { background: #1976D2; }
        .info { 
            background: white; 
            padding: 20px; 
            border-radius: 10px; 
            margin: 15px 0;
            border-left: 4px solid #FF6B35;
        }
        .critical { 
            background: #ffebee; 
            border-left: 4px solid #f44336;
            padding: 20px;
            border-radius: 10px;
            margin: 15px 0;
        }
        .success {
            background: #e8f5e8;
            border-left: 4px solid #4CAF50;
            padding: 20px;
            border-radius: 10px;
            margin: 15px 0;
        }
    </style>
</head>
<body>
    <h1>üéØ FINAL MOBILE MERCURYO TEST</h1>
    <h2>üì± iPhone 12 Pro Validation</h2>
    
    <div class="info">
        <strong>Your Device:</strong> <span id="device"></span><br>
        <strong>Mobile Detected:</strong> <span id="isMobile"></span><br>
        <strong>User Agent:</strong> <br><span id="userAgent" style="font-size: 12px; word-break: break-all;"></span>
    </div>
    
    <div class="critical">
        <h3>üö® CRITICAL ISSUE TO SOLVE</h3>
        <p><strong>Your Screenshot Shows:</strong></p>
        <ul>
            <li>‚úÖ Mercuryo has GREEN CHECKMARK (appears selected)</li>
            <li>‚ùå But SimpleSwap STILL defaults to MoonPay</li>
            <li>‚ùå EUR 21.42 currency is working BUT not fixing provider</li>
        </ul>
        <p><strong>Root Cause:</strong> SimpleSwap's mobile algorithm overrides visual selection</p>
    </div>
    
    <button class="test-button main-test" onclick="testMainSiteSolution()">
        üöÄ TEST MAIN SITE SOLUTION
        <br><small>Enhanced Desktop Spoofing + Multiple Strategies</small>
    </button>
    
    <button class="test-button comparison" onclick="testDirectEUR()">
        üìã TEST DIRECT EUR (Your Screenshot)
        <br><small>What you experienced - for comparison</small>
    </button>
    
    <div class="success">
        <h3>üéØ WHAT TO LOOK FOR:</h3>
        <p><strong>Main Site Solution Should:</strong></p>
        <ol>
            <li>Show blue "Enhanced Mercuryo Mode Active" page</li>
            <li>Display "iPhone 12 Pro ‚Üí Windows Desktop"</li>
            <li>Try multiple strategies with logging</li>
            <li><strong>RESULT: Mercuryo selected WITHOUT MoonPay override</strong></li>
        </ol>
        
        <p><strong>Direct EUR Should:</strong></p>
        <ol>
            <li>Go directly to SimpleSwap</li>
            <li>Show EUR 21.42 (like your screenshot)</li>
            <li>Show Mercuryo with green checkmark</li>
            <li><strong>PROBLEM: Still defaults to MoonPay ‚ùå</strong></li>
        </ol>
    </div>
    
    <div class="info">
        <h3>üîß ENHANCED SOLUTION FEATURES:</h3>
        <ul>
            <li><strong>Desktop User Agent:</strong> Windows Chrome 120</li>
            <li><strong>Screen Override:</strong> 1920x1080 resolution</li>
            <li><strong>Multiple URL Strategies:</strong>
                <br>‚Ä¢ preferred=mercuryo
                <br>‚Ä¢ provider=mercuryo  
                <br>‚Ä¢ device=desktop
            </li>
            <li><strong>Enhanced Properties:</strong> Vendor, platform override</li>
        </ul>
    </div>

    <script>
        // Display device info
        document.getElementById('device').textContent = /iPhone|iPad|iPod/i.test(navigator.userAgent) ? 'iOS Device' : 
                                                      /Android/i.test(navigator.userAgent) ? 'Android Device' : 'Desktop';
        document.getElementById('isMobile').textContent = /iPhone|Android|Mobile/i.test(navigator.userAgent) ? 'YES ‚úÖ' : 'NO ‚ùå';
        document.getElementById('userAgent').textContent = navigator.userAgent;
        
        // MAIN SITE SOLUTION TEST - Same as deployed on auralo-website-fixed.netlify.app
        function testMainSiteSolution() {
            console.log('üöÄ TESTING MAIN SITE ENHANCED SOLUTION');
            
            const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
            
            if (isMobile) {
                console.log('üì± MOBILE DETECTED: Applying enhanced desktop spoofing');
                
                const form = document.createElement('form');
                form.method = 'POST';
                
                const enhancedDesktopHTML = '<html><head><title>Enhanced Mercuryo Mode</title>' +
                    '<meta name="viewport" content="width=1920,initial-scale=1.0"></head>' +
                    '<body style="font-family:Arial;text-align:center;padding:50px;background:#2196F3;color:white;">' +
                    '<h2>üöÄ Enhanced Mercuryo Mode Active</h2>' +
                    '<div style="border:4px solid rgba(255,255,255,0.3);border-radius:50%;border-top:4px solid white;width:40px;height:40px;animation:spin 1s linear infinite;margin:20px auto;"></div>' +
                    '<p>iPhone 12 Pro ‚Üí Windows Desktop ‚Üí Mercuryo Selection</p>' +
                    '<p>Applying enhanced parameters...</p>' +
                    '<style>@keyframes spin{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}</style>' +
                    '<script>' +
                    'Object.defineProperty(navigator,"userAgent",{value:"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36",writable:false});' +
                    'Object.defineProperty(navigator,"platform",{value:"Win32",writable:false});' +
                    'Object.defineProperty(navigator,"vendor",{value:"Google Inc.",writable:false});' +
                    'Object.defineProperty(screen,"width",{value:1920,writable:false});' +
                    'Object.defineProperty(screen,"height",{value:1080,writable:false});' +
                    'const strategies=["https://simpleswap.io/?from=eur&to=pol&amount=15&partner=auralo&preferred=mercuryo","https://simpleswap.io/?from=eur&to=pol&amount=15&partner=auralo&provider=mercuryo","https://simpleswap.io/?from=eur&to=pol&amount=15&partner=auralo&device=desktop"];' +
                    'let currentStrategy=0;' +
                    'function tryStrategy(){if(currentStrategy<strategies.length){console.log("üîÑ Strategy",currentStrategy+1);window.location.href=strategies[currentStrategy];currentStrategy++;}else{console.log("üì± Fallback");window.location.href="https://simpleswap.io/?from=eur&to=pol&amount=15&partner=auralo";}}' +
                    'setTimeout(tryStrategy,1500);' +
                    '</script></body></html>';
                
                form.action = 'data:text/html;charset=utf-8,' + encodeURIComponent(enhancedDesktopHTML);
                form.target = '_blank';
                form.style.display = 'none';
                
                document.body.appendChild(form);
                form.submit();
                document.body.removeChild(form);
                
                console.log('‚úÖ Enhanced desktop spoofing activated');
            } else {
                console.log('üñ•Ô∏è Desktop detected - using enhanced parameters');
                window.open('https://simpleswap.io/?from=eur&to=pol&amount=15&partner=auralo&preferred=mercuryo', '_blank');
            }
        }
        
        // DIRECT EUR TEST - What user experienced in screenshot
        function testDirectEUR() {
            console.log('üìã Testing direct EUR (your screenshot scenario)');
            window.open('https://simpleswap.io/?from=eur&to=pol&amount=15&partner=auralo', '_blank');
        }
        
        console.log('‚úÖ Final mobile test functions loaded');
        console.log('üì± Device Type:', /iPhone|Android|Mobile/i.test(navigator.userAgent) ? 'MOBILE' : 'DESKTOP');
        console.log('üîç Ready for comprehensive testing');
    </script>
</body>
</html>