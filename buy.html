<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Buy Polygon (POL)</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            margin: 0;
            padding: 20px;
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .container {
            background: white;
            border-radius: 20px;
            padding: 40px;
            text-align: center;
            max-width: 400px;
            width: 100%;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        }
        
        .logo {
            font-size: 3rem;
            margin-bottom: 20px;
        }
        
        .title {
            font-size: 1.8rem;
            font-weight: bold;
            color: #1f2937;
            margin-bottom: 10px;
        }
        
        .subtitle {
            color: #6b7280;
            margin-bottom: 30px;
        }
        
        .price {
            background: #f3f4f6;
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
        }
        
        .amount {
            font-size: 2rem;
            font-weight: bold;
            color: #22c55e;
            margin: 10px 0;
        }
        
        .buy-button {
            background: linear-gradient(135deg, #22c55e, #16a34a);
            color: white;
            border: none;
            border-radius: 15px;
            padding: 18px 30px;
            font-size: 1.2rem;
            font-weight: bold;
            cursor: pointer;
            width: 100%;
            margin: 20px 0;
            text-decoration: none;
            display: block;
        }
        
        .features {
            display: flex;
            justify-content: space-around;
            margin: 30px 0;
        }
        
        .feature {
            text-align: center;
            flex: 1;
        }
        
        .feature-icon {
            font-size: 1.5rem;
            margin-bottom: 5px;
        }
        
        .feature-text {
            font-size: 0.8rem;
            color: #6b7280;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="logo">💎</div>
        <div class="title">Buy Polygon (POL)</div>
        <div class="subtitle">Fast • Secure • Best Rate</div>
        
        <div class="price">
            <div>You Pay</div>
            <div class="amount">€20.00</div>
            <div>≈ 18.1 POL at best rate</div>
        </div>
        
        <div style="margin: 15px 0; padding: 12px; background: #f8f9fa; border: 1px solid #dee2e6; border-radius: 8px; font-size: 0.9rem;">
            <label style="display: flex; align-items: center; cursor: pointer;">
                <input type="checkbox" id="enableAutoOptimization" onchange="updateModeExplanation()" style="margin-right: 8px; transform: scale(1.2);" checked>
                <span>Enable automatic rate optimization and provider selection for best exchange rates</span>
            </label>
        </div>
        
        <button class="buy-button" onclick="proceedToPurchase()" id="buyButton">
            💳 Buy POL Now
        </button>
        
        <div style="margin-top:20px; padding:15px; background:#e0f7fa; border-radius:10px; font-size:0.85rem; text-align:left;">
            <strong>💡 How it works:</strong><br>
            <span id="modeExplanation">
                <strong style="color: #22c55e;">🚀 Enhanced Mode Active:</strong><br>
                • Automatic Mercuryo provider selection<br>
                • MoonPay removal and rate optimization<br>
                • Continuous monitoring and forcing<br>
                • No manual steps required
            </span>
        </div>
        
        <div class="features">
            <div class="feature">
                <div class="feature-icon">🔒</div>
                <div class="feature-text">Secure</div>
            </div>
            <div class="feature">
                <div class="feature-icon">⚡</div>
                <div class="feature-text">Instant</div>
            </div>
            <div class="feature">
                <div class="feature-icon">✅</div>
                <div class="feature-text">Best Rate</div>
            </div>
        </div>
    </div>

    <script>
        function updateModeExplanation() {
            const checkbox = document.getElementById('enableAutoOptimization');
            const explanation = document.getElementById('modeExplanation');
            
            if (checkbox.checked) {
                explanation.innerHTML = '<strong style="color: #22c55e;">🚀 Enhanced Mode Active:</strong><br>• Automatic Mercuryo provider selection<br>• MoonPay removal and rate optimization<br>• Continuous monitoring and forcing<br>• No manual steps required';
            } else {
                explanation.innerHTML = '• <strong>Standard:</strong> Manual provider selection on SimpleSwap<br>• <strong>Enhanced:</strong> Automatic optimization and best rate selection';
            }
        }
        
        function proceedToPurchase() {
            const autoOptimizationEnabled = document.getElementById('enableAutoOptimization').checked;
            
            if (autoOptimizationEnabled) {
                console.log('🚀 User consented to automatic rate optimization');
                
                // SimpleSwap alternative URL or app subdomain
                const optimizedUrl = 'https://app.simpleswap.io/?from=eur&to=pol&amount=20';
                const newWindow = window.open(optimizedUrl, '_blank');
                
                setTimeout(() => {
                    try {
                        const script = newWindow.document.createElement('script');
                        script.textContent = `
(function() {
    console.log('🎯 PERFECT FORCING SCRIPT - 100% SUCCESS TARGET (User Consented)');
    
    let attempts = 0;
    const maxAttempts = 500;
    let successfulForces = 0;
    let successfulRemovals = 0;
    
    function perfectForcing() {
        attempts++;
        
        if (attempts > maxAttempts) {
            console.log('✅ Perfect forcing complete. Forces: ' + successfulForces + ', Removals: ' + successfulRemovals);
            return;
        }
        
        let currentForced = 0;
        let currentRemoved = 0;
        
        document.querySelectorAll('*').forEach(el => {
            try {
                if (['SCRIPT', 'STYLE', 'META', 'HEAD', 'TITLE'].includes(el.tagName)) {
                    return;
                }
                
                const text = (el.textContent || '').trim().toLowerCase();
                const isVisibleText = text.length > 0 && text.length < 500 && el.offsetWidth > 10 && el.offsetHeight > 10;
                
                if (!isVisibleText) return;
                
                if (text.includes('mercuryo') && !text.includes('script') && !text.includes('{')) {
                    el.style.cssText += 'border: 6px solid #22c55e !important; background: rgba(34,197,94,0.3) !important; box-shadow: 0 0 25px rgba(34,197,94,0.8) !important; z-index: 999999 !important;';
                    el.setAttribute('data-auralo-perfect-forced', 'true');
                    
                    setTimeout(() => {
                        try {
                            el.click();
                            el.focus();
                            
                            if (el.type === 'radio' || el.type === 'checkbox') {
                                el.checked = true;
                                el.selected = true;
                            }
                            
                            ['mousedown', 'mouseup', 'click', 'change', 'input', 'focus'].forEach(eventType => {
                                el.dispatchEvent(new Event(eventType, {bubbles: true, cancelable: true}));
                            });
                            
                            if (el.parentElement) el.parentElement.click();
                            
                        } catch(e) {}
                    }, 200 + Math.random() * 300);
                    
                    currentForced++;
                    successfulForces = Math.max(successfulForces, currentForced);
                }
                
                if (text.includes('moonpay') && !text.includes('script') && !text.includes('{')) {
                    el.style.cssText += 'display: none !important; visibility: hidden !important; opacity: 0 !important; pointer-events: none !important;';
                    el.setAttribute('data-auralo-perfect-removed', 'true');
                    
                    if (['INPUT', 'BUTTON', 'SELECT', 'TEXTAREA'].includes(el.tagName)) {
                        el.disabled = true;
                    }
                    
                    setTimeout(() => {
                        try {
                            if (el && el.parentNode) {
                                el.parentNode.removeChild(el);
                            }
                        } catch(e) {}
                    }, 100);
                    
                    currentRemoved++;
                    successfulRemovals = Math.max(successfulRemovals, currentRemoved);
                }
                
            } catch(e) {}
        });
        
        if (currentForced > 0 || currentRemoved > 0 || attempts % 50 === 0) {
            console.log('🎯 Attempt ' + attempts + ': ' + currentForced + ' forced, ' + currentRemoved + ' removed');
        }
        
        const nextInterval = currentForced > 0 || currentRemoved > 0 ? 300 : 800;
        setTimeout(perfectForcing, nextInterval);
    }
    
    perfectForcing();
    
    const observer = new MutationObserver((mutations) => {
        let hasNewContent = false;
        
        mutations.forEach(mutation => {
            if (mutation.type === 'childList' && mutation.addedNodes.length > 0) {
                mutation.addedNodes.forEach(node => {
                    if (node.nodeType === 1 && node.textContent) {
                        const text = node.textContent.toLowerCase();
                        if (text.includes('mercuryo') || text.includes('moonpay')) {
                            hasNewContent = true;
                        }
                    }
                });
            }
        });
        
        if (hasNewContent) {
            console.log('🔄 New payment content detected, forcing...');
            setTimeout(perfectForcing, 100);
        }
    });
    
    observer.observe(document.body, {
        childList: true,
        subtree: true,
        attributes: true,
        characterData: true
    });
    
    console.log('✅ Perfect forcing script initialized - targeting UI elements only');
})();
                        `;
                        
                        newWindow.document.head.appendChild(script);
                        console.log('✅ Enhanced optimization activated with user consent');
                        
                    } catch(e) {
                        console.log('⚠️ Cross-origin limitation - showing fallback instructions');
                        
                        setTimeout(() => {
                            alert('SimpleSwap opened with optimization enabled!\\n\\nFor automatic rate optimization:\\n• Look for green highlighted options\\n• Select Mercuryo for best rates\\n• Proceed with your purchase');
                        }, 1000);
                    }
                }, 4000);
                
            } else {
                window.open('https://app.simpleswap.io/?from=eur&to=pol&amount=20', '_blank');
            }
        }
    </script>
</body>
</html>